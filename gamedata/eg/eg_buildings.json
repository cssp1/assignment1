// Copyright (c) 2015 SpinPunch Studios. All rights reserved.
// Use of this source code is governed by an MIT-style license that can be
// found in the LICENSE file.

{
    "toc": {
        // must be the same as the key name above
        "name": "toc",

        // name displayed to the player
        "ui_name": "Tactical Ops Center",
        "ui_name_indefinite": "a Tactical Ops Center",
        "ui_name_abbreviation": "TOC",

        // "Flavor text" displayed in the unit or building info/upgrade dialogs
        // Use \n for line breaks
        "ui_description": "Upgrade to increase maximum space for troops under your command. Allows additional resource buildings and defense structures to be built.",

        "ui_congrats_viral": "upgrade_toc",

        // must be "building" for all buildings
        "kind": "building",

        // how big the building is in game map units
        // [x-axis size, z-axis size]
        "gridsize": [18,18],

        // how large of an area the building prevents unit
        // movement through. This must be less than or equal to
        // gridsize.
        "unit_collision_gridsize": [16,16],

        // pixel width, height, and vertical altitude of the health bar (useful to move it up or down for tall or squat buildings)
        // You can usually omit this field. ONLY add it if you notice the health bar looking wrong.
        "health_bar_dims": [160,8,104],

        // name of the art asset - this references an entry in art.json
        "art_asset": ["toc_L1",
                      "toc_L2",
                      "toc_L3"
                     ],
        // art assets to use for building when destroyed or under construction
        "destroyed_asset": "building_crater_16x16",
        "under_construction_asset": "building_construction_16x16",
        // for equip icons ("nubs"), offset of origin from center of building, and delta between successive icons, in map units
        "equip_icon_offset": [-3,9.5], "equip_icon_delta": [1.5,0],

        // this refers to a file in our public S3 bucket at gamedata['virals']['common_image_path']
        // it is used to iconify this building when displayed outside
        // the game, e.g. in a Facebook feed post
        // (obsolete, not used currently)
        "external_art_asset": "toc2.jpg",

        // the hitpoints of a fully healthy building
        "max_hp":        [4250,8000,9000],

        // list of any special weapon damage modifiers that apply to this building.
        // corresponds to the "damage_vs" table for weapon in spells.json.
        "defense_types": ["building"],

        // how much unit space the building provides (central computer only)
        "provides_space": [575,690,1075],

        // how much time (in seconds) the building takes to construct or upgrade
        "build_time": [70,295,14550],

        // how much time (in seconds) the building takes to repair from zero hitpoints
        "repair_time": [4,900,2280],

        // how many units of power the building consumes
        "consumes_power": [26,52,74],

        // how many units of power the building consumes while constructing or upgrading
        "consumes_power_while_building": [0,26,37],

        // how many units of iron and water the building can store
        "storage_iron": 9580,
        "storage_water": 9580,

        // how many units of iron and water the building takes to construct or upgrade
        "build_cost_water": [560,19100,110000],
        "build_cost_iron":  [560,19100,110000],

        // Facebook credit cost to build/upgrade this structure
        "upgrade_credit_cost": [-1,2,16],

        "upgrade_speedup_cost_factor": [1,1,1], // this brings speed-up cost in line with instant upgrade cost

        // if true, record level as a TOP-LEVEL player.history metric (only use for tech-path-critical buildings)
        "track_level_in_player_history": true,

        // track  number killed/lost/built/maxlevel in player.history
        "history_category": "tocs",

        // spells the unit is capable of casting
        "spells": ["UPGRADE_FOR_FREE", "CANCEL_UPGRADE", "REPAIR", "MOVE_BUILDING"],

        // how many copies of this building you are allowed to have
        // (if an array, it's indexed by central computer level)
        "limit": 1,

        // list "N iron/water storages" as a prerequisite for upgrading the CC. This ensures that players
        // have to realize they can build more storage units (to hold enough iron/water) before upgrading the CC.
        "requires": [
            { "predicate": "ALWAYS_TRUE" }, // L1

            { "predicate": "AND", "subpredicates": [ // L2
                { "predicate": "BUILDING_LEVEL", "building_type": "supply_depot", "trigger_level": 2 },
                { "predicate": "BUILDING_LEVEL", "building_type": "fuel_depot", "trigger_level": 2 }
            ]},
            { "predicate": "AND", "subpredicates": [ // L3
                { "predicate": "BUILDING_LEVEL", "building_type": "supply_depot", "trigger_level": 2, "trigger_qty": 2 }, // XXXXXX should be L4
                { "predicate": "BUILDING_LEVEL", "building_type": "fuel_depot", "trigger_level": 2, "trigger_qty": 2 } // XXXXXX should be L4
            ]}
        ],

        // SPFX effect that will go off when the building is destroyed (you'll get a default effect if one is not listed)
        "explosion_effect": {
            "type": "combine", "effects": [

                // inner random fires
                { "type": "particles", "require_detail": 2,
                  "max_count": 25,
                  "emit_continuous_rate": 50, "emit_continuous_for": 0.75,
                  "radius": 4.0, "speed": 0, "max_age": 2.5,
                  "child": { "type": "explosion", "sprite": "fx/aexp_plain", "composite_mode": "lighter", "opacity": 0.66 }
                },
                // outer random fires
                { "type": "particles", "require_detail": 2, "delay": 0.2,
                  "max_count": 75, "emit_pattern": "circle",
                  "emit_continuous_rate": 75, "emit_continuous_for": 0.66,
                  "radius": 8.0, "speed": 0, "max_age": 2.5,
                  "child": { "type": "explosion", "sprite": "fx/fexp", "composite_mode": "lighter", "opacity": 0.66 }
                },

                // big debris "pipes" flying outward
                { "type": "particles", "emit_instant": 50, "max_count": 50, "radius": 4.0, "speed": 6, "speed_random": 15, "max_age": 3.0, "color": [0.03,0.03,0.03,1],
                  "draw_mode": "lines", "width": 2, "fixed_length": 0.6, "spin_rate":240 },

                // little debris "pipes" flying outward
                { "type": "particles", "emit_instant": 30, "max_count": 30, "radius": 4.0, "speed": 12, "speed_random": 15, "max_age": 2.5, "color": [0.05,0.05,0.05,1],
                  "draw_mode": "lines", "width": 2, "fixed_length": 0.25, "spin_rate":480 },

                // "fireworks" ejection with fireballs following each particle
                { "type": "particles", "require_detail": 2, "emit_instant": 10, "max_count": 10, "radius": 3.0, "speed": 15, "speed_random": 12, "gravity": -25, "max_age": 1, "color": [1,1,0.5,1],
                  "draw_mode": "none", "width": 3, "min_length": 0.05, // leading "fireworks" particle streaks ("draw_mode": "lines" to enable)
                  "child": {"type": "particles", // trailing fireballs
                            "emit_continuous_rate":20, "emit_continuous_for": 1, "max_age": 0.8, "max_count": 60, "speed": 0.5, "randomize_vel": 0.27, "spin_rate": 0.1,
                            "gravity": 50, "collide_ground": false, "child": { "type": "explosion", "sprite": "fx/fexp" }
                           }
                },

                // "fireworks" ejection with smoke trail following each particle
                { "type": "particles", "emit_instant": 35, "max_count": 60, "radius": 4.0, "speed": 10, "speed_random":12, "emit_continuous_for": 0.25, "emit_continuous_rate": 10,
                  "gravity": -15, "max_age": 2.0, "color": [1,0.75,0.25,1],
                  "draw_mode": "lines", "width": 2, "min_length": 0.05, // leading "fireworks" particle streaks
                  "child": {"type": "particles", "require_detail": 2, // trailing smoke
                            "emit_continuous_rate": 50, "emit_continuous_for": 1.33, "max_age": 1.2, "max_count": 50, "speed": 0.5, "randomize_vel": 0.27,
                            "gravity": -5, "collide_ground": false,
                            "width": 10, "opacity": 0.5, "draw_mode": "circles",
                            "color": [0.1,0.1,0.1,1] }
                },

                // bright particle ejection (only used in low-detail mode)
                { "type": "particles", "max_detail": 2, "emit_instant": 250, "max_count": 250, "radius": 3.0, "speed": 10, "max_age": 2.0, "color": [1,0.5,0.25,1] },

                // main big flame
                { "type": "explosion", "delay": 0.25, "sprite": "fx/smallx_plain", "composite_mode": "lighter", "sprite_scale": 1.33 },

                { "type": "sound", "sprite": "fx/smallx_plain" },
                { "type": "camera_shake", "amplitude": -150, "decay_time": 0.5 },
                { "type": "shockwave", "color": [1,0.9,0.5], "opacity": 0.6,
                  "duration": 0.5, "speed": 1250, "thickness": 0.6 }
            ]
        }
    },
    "supply_yard": {
        "ui_name": "Supply Yard",
        "ui_name_indefinite": "a Supply Yard",
        "name": "supply_yard",
        "kind": "building",
        "ui_description": "Produces supplies. Upgrade this building to increase gather rate and capacity. Guard well - attackers can steal your supplies by destroying this building.",

        // which part of the "Build" menu this building shows up on.
        // can be "resources", "production", or "defense"
        "build_category": "resources",
        "history_category": "harvesters",

        "gridsize": [10,10],
        "equip_slots": { "leader": 1 },
        "unit_collision_gridsize": [8,8],
        "harvest_glow_pos": [-20,-40], // pixel offset of harvester glow effect
        "art_asset": "supply_yard",
        "equip_icon_offset": [-4,5], "equip_icon_delta": [1.5,0],

        "max_hp": [2000,2100],

        // invulnerable when in a quarry
        "quarry_invul": true,

        "defense_types": ["building"],

        "build_cost_water": [420,975],
        "build_cost_iron": [0,0],
        "build_time": [22,135],
        "repair_time": [4,120],
        "upgrade_credit_cost": [1,1],
        "consumes_power":                [16,45],
        "consumes_power_while_building": [0,23],

        // number of units of iron produced per hour
        "produces_iron": [2175,2590],

        // how many units of iron the harvester can hold before it fills up
        // NOTE! this also affects how much iron/water can be looted from AI harvesters!
        // see harvester_factor in server.py:object_combat_updates()
        "production_capacity": [10500,11500],

        "spells": ["HARVEST", "UPGRADE_FOR_FREE", "CANCEL_UPGRADE", "MOVE_BUILDING"],
        "requires": [
            { "predicate": "ALWAYS_TRUE" },
            { "predicate": "BUILDING_LEVEL", "building_type": "toc", "trigger_level": 2 }
        ],
        "limit": [1,2,3],

        // special explosion effect with more "pipes" than usual
        "explosion_effect": { "type": "combine", "effects": [
            // random fires
            { "type": "particles", "require_detail": 2,
              "max_count": 25,
              "emit_continuous_rate": 50, "emit_continuous_for": 0.25,
              "radius": 4.0, "speed": 0, "max_age": 2.5,
              "child": { "type": "explosion", "sprite": "fx/fexp", "composite_mode": "lighter", "opacity": 0.66 }
            },

            // big debris "pipes" flying outward
            { "type": "particles", "emit_instant": 50, "max_count": 50, "radius": 4.0, "speed": 6, "speed_random": 15, "max_age": 3.0, "color": [0.03,0.03,0.03,1],
              "draw_mode": "lines", "width": 2, "fixed_length": 0.5, "spin_rate":460 },

            // little debris "pipes" flying outward
            { "type": "particles", "emit_instant": 60, "max_count": 60, "radius": 4.0, "speed": 12, "speed_random": 15, "max_age": 2.5, "color": [0.05,0.05,0.05,1],
              "draw_mode": "lines", "width": 2, "fixed_length": 0.25, "spin_rate":480 },

            // "fireworks" ejection with smoke trail following each particle
            { "type": "particles", "emit_instant": 20, "max_count": 12, "radius": 4.0, "speed": 12,
              "gravity": -25, "max_age": 1.5, "color": [1,0.75,0.25,1],
              "draw_mode": "lines", "width": 2, "min_length": 0.05, // leading "fireworks" particle streaks
              "child": {"type": "particles", "require_detail": 2, // trailing smoke
                        "emit_continuous_rate": 40, "emit_continuous_for": 1.0, "max_age": 0.9, "max_count": 50, "speed": 0.5, "randomize_vel": 0.27,
                        "gravity": -5, "collide_ground": false,
                        "width": 10, "opacity": 0.5, "draw_mode": "circles",
                        "color": [0.1,0.1,0.1,1] }
            },

            // bright particle ejection (only used in low-detail mode)
            { "type": "particles", "max_detail": 2, "emit_instant": 250, "max_count": 250, "radius": 3.0, "speed": 6.5, "max_age": 1.8, "color": [1,0.5,0.25,1] },

            // main big flame
            { "type": "explosion", "sprite": "fx/zg02", "composite_mode": "lighter", "sprite_scale": 2 },
            { "type": "explosion", "sprite": "fx/smallx_plain", "composite_mode": "lighter", "sprite_scale": 0.5, "delay": 0.25, "offset": [2,0,0] },
            { "require_detail": 2, "type": "explosion", "opacity": 0.5, "sprite_scale": 3.0, "sprite": "fx/flak1_slow" },

            { "type": "camera_shake", "amplitude": -100, "decay_time": 0.4 },
            { "type": "sound", "assets": ["fx/smallx_plain"] }
        ] }
    },
    "fuel_yard": {
        "ui_name": "Fuel Yard",
        "ui_name_indefinite": "a Fuel Yard",
        "name": "fuel_yard",
        "kind": "building",
        "ui_description": "Produces fuel. Upgrade this building to increase gather rate and capacity. Guard well - attackers can steal your fuel by destroying this building.",

        "build_category": "resources",
        "history_category": "harvesters",
        "gridsize": [10,10],
        "unit_collision_gridsize": [8,8],
        "harvest_glow_pos": [-6,-45], // pixel offset of harvester glow effect
        "art_asset": "fuel_yard",
        "equip_icon_offset": [-4,5], "equip_icon_delta": [1.5,0],
        "max_hp": [2000,2100],
        // invulnerable when in a quarry
        "quarry_invul": true,
        "defense_types": ["building"],
        "build_cost_water": 0,
        "build_cost_iron": [420,975],
        "build_time": [22,135],
        "repair_time": [4,120],
        "upgrade_credit_cost": [1,1],
        "consumes_power": [16,45],
        "consumes_power_while_building": [0,23],
        "produces_water": [2175,2590],
        "production_capacity": [10500,11500],
        "spells": ["HARVEST", "UPGRADE_FOR_FREE", "CANCEL_UPGRADE", "MOVE_BUILDING"],
        "requires": [
            { "predicate": "ALWAYS_TRUE" },
            { "predicate": "BUILDING_LEVEL", "building_type": "toc", "trigger_level": 2 }
        ],
        "limit": [1,2,2],

        // special, extra-firey explosion effect
        "explosion_effect": {
            "type": "combine", "effects": [
                // random fires
                { "type": "particles", "require_detail": 2,
                  "max_count": 50,
                  "emit_continuous_rate": 50, "emit_continuous_for": 0.5,
                  "radius": 3.0, "speed": 0, "max_age": 2.5,
                  "child": { "type": "explosion", "sprite": "fx/aexp_plain", "composite_mode": "lighter", "opacity": 0.66 }
                },

                // big debris "pipes" flying outward
                { "type": "particles", "emit_instant": 20, "max_count": 20, "radius": 4.0, "speed": 6, "speed_random": 15, "max_age": 3.0, "color": [0.03,0.03,0.03,1],
                  "draw_mode": "lines", "width": 2, "fixed_length": 0.5, "spin_rate":240 },

                // "fireworks" ejection with fireballs following each particle
                { "type": "particles", "emit_instant": 13, "max_count": 13, "radius": 3.0, "speed": 10, "speed_random": 17, "gravity": -25, "max_age": 1.33, "color": [1,1,0.5,1],
                  "draw_mode": "none", "width": 3, "min_length": 0.05, // leading "fireworks" particle streaks ("draw_mode": "lines" to enable)
                  "child": {"type": "particles", // trailing fireballs
                            "emit_continuous_rate":20, "emit_continuous_for": 1, "max_age": 1.0, "max_count": 60, "speed": 0.5, "randomize_vel": 0.27, "spin_rate": 0.1,
                            "gravity": 50, "collide_ground": false, "child": { "type": "explosion", "sprite": "fx/fexp", "composite_mode": "lighter", "opacity": 0.5 }
                           }
                },
                // same as previous but wiht smaller fireballs
                { "type": "particles", "emit_instant": 13, "max_count": 13, "radius": 3.0, "speed": 10, "speed_random": 17, "gravity": -25, "max_age": 1.33, "color": [1,1,0.5,1],
                  "draw_mode": "none", "width": 3, "min_length": 0.05, // leading "fireworks" particle streaks ("draw_mode": "lines" to enable)
                  "child": {"type": "particles", // trailing fireballs
                            "emit_continuous_rate":20, "emit_continuous_for": 1, "max_age": 1.0, "max_count": 60, "speed": 0.5, "randomize_vel": 0.27, "spin_rate": 0.1,
                            "gravity": 50, "collide_ground": false, "child": { "type": "explosion", "sprite": "fx/fexp", "composite_mode": "lighter", "opacity": 0.66, "sprite_scale": 0.6 }
                           }
                },

                // bright particle ejection (only used in low-detail mode)
                { "type": "particles", "max_detail": 2, "emit_instant": 250, "max_count": 250, "radius": 3.0, "speed": 6.5, "max_age": 1.8, "color": [1,0.5,0.25,1] },

                // main big flame
                { "type": "explosion", "sprite": "fx/smallx_plain", "composite_mode": "lighter" },
                { "require_detail": 2, "type": "explosion", "opacity": 0.5, "sprite_scale": 3.0, "sprite": "fx/flak1_slow" },

                { "type": "camera_shake", "amplitude": -100, "decay_time": 0.4 },
                { "type": "sound", "assets": ["fx/smallx_plain"] }
            ] }
    },
    "supply_depot": {
        "ui_name": "Supply Depot",
        "ui_name_indefinite": "a Supply Depot",
        "ui_name_plural": "Supply Depots",
        "name": "supply_depot",
        "kind": "building",
        "ui_description": "Stores supplies. Upgrade to increase storage capacity. Guard well - attackers can steal supplies by destroying this depot.",
        "build_category": "resources",
        "history_category": "storages",
        "gridsize": [9,9],
        "unit_collision_gridsize": [7,7],
        "art_asset": "supply_depot",
        "equip_icon_offset": [3.3,3], "equip_icon_delta": [0,-1.5],
        "max_hp": [1000,2000],
        "defense_types": ["building"],
        "build_cost_iron": [285,735],
        "build_cost_water": [285,735],
        "build_time": [28,112],
        "repair_time": [5,5],

        "upgrade_credit_cost": [1,1],
        "consumes_power": [6,12],
        "consumes_power_while_building": [0,6],
        "storage_iron": [36020,59500],
        "spells": ["UPGRADE_FOR_FREE", "CANCEL_UPGRADE", "MOVE_BUILDING"],
        "requires": [
            { "predicate": "ALWAYS_TRUE" },
            { "predicate": "ALWAYS_TRUE" }
        ],
        "limit": [1,2,2],

        // special explosion effect with more "pipes" than usual
        "explosion_effect": { "type": "combine", "effects": [
            // random fires
            { "type": "particles", "require_detail": 2,
              "max_count": 25,
              "emit_continuous_rate": 50, "emit_continuous_for": 0.25,
              "radius": 4.0, "speed": 0, "max_age": 2.5,
              "child": { "type": "explosion", "sprite": "fx/fexp", "composite_mode": "lighter", "opacity": 0.66 }
            },

            // big debris "pipes" flying outward
            { "type": "particles", "emit_instant": 50, "max_count": 50, "radius": 4.0, "speed": 6, "speed_random": 15, "max_age": 3.0, "color": [0.03,0.03,0.03,1],
              "draw_mode": "lines", "width": 2, "fixed_length": 0.5, "spin_rate":460 },

            // little debris "pipes" flying outward
            { "type": "particles", "emit_instant": 60, "max_count": 60, "radius": 4.0, "speed": 12, "speed_random": 15, "max_age": 2.5, "color": [0.05,0.05,0.05,1],
              "draw_mode": "lines", "width": 2, "fixed_length": 0.25, "spin_rate":480 },

            // "fireworks" ejection with smoke trail following each particle
            { "type": "particles", "emit_instant": 20, "max_count": 12, "radius": 4.0, "speed": 12,
              "gravity": -25, "max_age": 1.5, "color": [1,0.75,0.25,1],
              "draw_mode": "lines", "width": 2, "min_length": 0.05, // leading "fireworks" particle streaks
              "child": {"type": "particles", "require_detail": 2, // trailing smoke
                        "emit_continuous_rate": 40, "emit_continuous_for": 1.0, "max_age": 0.9, "max_count": 50, "speed": 0.5, "randomize_vel": 0.27,
                        "gravity": -5, "collide_ground": false,
                        "width": 10, "opacity": 0.5, "draw_mode": "circles",
                        "color": [0.1,0.1,0.1,1] }
            },

            // bright particle ejection (only used in low-detail mode)
            { "type": "particles", "max_detail": 2, "emit_instant": 250, "max_count": 250, "radius": 3.0, "speed": 6.5, "max_age": 1.8, "color": [1,0.5,0.25,1] },

            // main big flame
            { "type": "explosion", "sprite": "fx/zg02", "composite_mode": "lighter", "sprite_scale": 2 },
            { "type": "explosion", "sprite": "fx/smallx_plain", "composite_mode": "lighter", "sprite_scale": 0.5, "delay": 0.25, "offset": [2,0,0] },
            { "require_detail": 2, "type": "explosion", "opacity": 0.5, "sprite_scale": 3.0, "sprite": "fx/flak1_slow" },

            { "type": "camera_shake", "amplitude": -100, "decay_time": 0.4 },
            { "type": "sound", "assets": ["fx/smallx_plain"] }
        ] }
    },
    "fuel_depot": {
        "ui_name": "Fuel Depot",
        "ui_name_indefinite": "a Fuel Depot",
        "ui_name_plural": "Fuel Depots",
        "name": "fuel_depot",
        "kind": "building",
        "ui_description": "Stores fuel. Upgrade to increase storage capacity. Guard well - attackers can steal fuel by destroying this depot.",
        "build_category": "resources",
        "history_category": "storages",
        "gridsize": [10,10],
        "unit_collision_gridsize": [8,8],
        "art_asset": "fuel_depot",
        "equip_icon_offset": [-4,5.4], "equip_icon_delta": [1.5,0],
        "max_hp": [1000,2000],
        "defense_types": ["building"],
        "build_cost_iron": [285,735],
        "build_cost_water": [285,7350],
        "build_time": [28,112],
        "repair_time": [5,5],
        "upgrade_credit_cost": [1,1],
        "consumes_power": [6,12],
        "consumes_power_while_building": [0,6],
        "storage_water": [36020,59500],
        "spells": ["UPGRADE_FOR_FREE", "CANCEL_UPGRADE", "MOVE_BUILDING"],
        "requires": [
            { "predicate": "ALWAYS_TRUE" },
            { "predicate": "ALWAYS_TRUE" }
        ],
        "limit": [1,2,2],

        // special, extra-firey explosion effect
        "explosion_effect": {
            "type": "combine", "effects": [
                // random fires
                { "type": "particles", "require_detail": 2,
                  "max_count": 50,
                  "emit_continuous_rate": 50, "emit_continuous_for": 0.5,
                  "radius": 3.0, "speed": 0, "max_age": 2.5,
                  "child": { "type": "explosion", "sprite": "fx/aexp_plain", "composite_mode": "lighter", "opacity": 0.66 }
                },

                // big debris "pipes" flying outward
                { "type": "particles", "emit_instant": 20, "max_count": 20, "radius": 4.0, "speed": 6, "speed_random": 15, "max_age": 3.0, "color": [0.03,0.03,0.03,1],
                  "draw_mode": "lines", "width": 2, "fixed_length": 0.5, "spin_rate":240 },

                // "fireworks" ejection with fireballs following each particle
                { "type": "particles", "emit_instant": 13, "max_count": 13, "radius": 3.0, "speed": 10, "speed_random": 17, "gravity": -25, "max_age": 1.33, "color": [1,1,0.5,1],
                  "draw_mode": "none", "width": 3, "min_length": 0.05, // leading "fireworks" particle streaks ("draw_mode": "lines" to enable)
                  "child": {"type": "particles", // trailing fireballs
                            "emit_continuous_rate":20, "emit_continuous_for": 1, "max_age": 1.0, "max_count": 60, "speed": 0.5, "randomize_vel": 0.27, "spin_rate": 0.1,
                            "gravity": 50, "collide_ground": false, "child": { "type": "explosion", "sprite": "fx/fexp", "composite_mode": "lighter", "opacity": 0.5 }
                           }
                },
                // same as previous but wiht smaller fireballs
                { "type": "particles", "emit_instant": 13, "max_count": 13, "radius": 3.0, "speed": 10, "speed_random": 17, "gravity": -25, "max_age": 1.33, "color": [1,1,0.5,1],
                  "draw_mode": "none", "width": 3, "min_length": 0.05, // leading "fireworks" particle streaks ("draw_mode": "lines" to enable)
                  "child": {"type": "particles", // trailing fireballs
                            "emit_continuous_rate":20, "emit_continuous_for": 1, "max_age": 1.0, "max_count": 60, "speed": 0.5, "randomize_vel": 0.27, "spin_rate": 0.1,
                            "gravity": 50, "collide_ground": false, "child": { "type": "explosion", "sprite": "fx/fexp", "composite_mode": "lighter", "opacity": 0.66, "sprite_scale": 0.6 }
                           }
                },

                // bright particle ejection (only used in low-detail mode)
                { "type": "particles", "max_detail": 2, "emit_instant": 250, "max_count": 250, "radius": 3.0, "speed": 6.5, "max_age": 1.8, "color": [1,0.5,0.25,1] },

                // main big flame
                { "type": "explosion", "sprite": "fx/smallx_plain", "composite_mode": "lighter" },
                { "require_detail": 2, "type": "explosion", "opacity": 0.5, "sprite_scale": 3.0, "sprite": "fx/flak1_slow" },

                { "type": "camera_shake", "amplitude": -100, "decay_time": 0.4 },
                { "type": "sound", "assets": ["fx/smallx_plain"] }
            ] }
    },
    "generator": {
        "ui_name": "Generator",
        "ui_name_plural": "Generators",
        "ui_name_indefinite": "a Generator",
        "name": "generator",
        "kind": "building",
        "ui_description": "Generates electricity to power buildings. When low on power, production and defense buildings become less effective. Upgrade to increase power production.",
        "build_category": "resources",
        "history_category": "generators",
        "gridsize": [14,14],
        "unit_collision_gridsize": [12,12],
        "art_asset": ["generator_L1",
                      "generator_L2",
                      "generator_L3",
                      "generator_L4"
                     ],
        "equip_icon_offset": [-4,5], "equip_icon_delta": [1.5,0],
        "max_hp": [5000,8000,11000,14000],
        "defense_types": ["building"],
        // invulnerable when in a quarry
        "quarry_invul": true,
        "provides_power": [120,240,400,700],
        "build_cost_iron": [2200,4900,13000,29950],
        "build_cost_water": [3000,8000,17960,49025],
        "build_time": [80,100,295,3650],
        "repair_time": [4,60,180,240],
        "upgrade_credit_cost": [1,2,4,8],
        "track_level_in_player_history": true,
        "spells": ["UPGRADE_FOR_FREE", "CANCEL_UPGRADE", "MOVE_BUILDING"],
        "requires": [
            { "predicate": "ALWAYS_TRUE" },
            { "predicate": "ALWAYS_TRUE" },
            { "predicate": "BUILDING_LEVEL", "building_type": "toc", "trigger_level": 2 },
            { "predicate": "ALWAYS_TRUE" }
        ],
        "limit": [2,2,2]
    },
    "quarry_generator": {
        // variant of the Energy Plant that has 100x normal output, useful for quarries where you want to have one plant
        // power everything easily
        "developer_only": 1,
        "ui_name": "Quarry Generator",
        "ui_name_indefinite": "a Quarry Generator",
        "name": "quarry_generator",
        "kind": "building",
        "ui_description": "Upgrade to produce more power. When energy levels are low, Light Rail Guns and Defensive Cannons do less damage, and harvesters gather resources more slowly.",
        "build_category": "resources",
        "history_category": "generators",
        "gridsize": [14,14],
        "unit_collision_gridsize": [12,12],
        "art_asset": ["generator_L1",
                      "generator_L2",
                      "generator_L3",
                      "generator_L4"
                     ],
        "equip_icon_offset": [-4,5], "equip_icon_delta": [1.5,0],
        "max_hp": [5000,8000,11000,14000],
        "defense_types": ["building"],
        // invulnerable when in a quarry
        "quarry_invul": true,
        "provides_power": [12000,24000,40000,70000],
        "build_cost_iron": [2200,4900,13000,29950],
        "build_cost_water": [3000,8000,17960,49025],
        "build_time": [80,275,1905,3650],
        "repair_time": [4,60,180,240],
        "upgrade_credit_cost": [1,2,4,8],
        "spells": ["UPGRADE_FOR_FREE", "CANCEL_UPGRADE", "MOVE_BUILDING"],
        "limit": [2,2,2]
    },
    "academy": {
        "ui_name": "Academy",
        "ui_name_indefinite": "an Academy",
        "name": "academy",
        "kind": "building",
        "build_category": "production",
        "ui_description": "Improves your soldiers. Upgrade this building to unlock and upgrade advanced infantry units.",
        "ui_congrats": ["Advanced training enabled.\n\nYou can now unlock and upgrade more advanced infantry.\n\nInfantry are the backbone of your army, use them to overwhelm the enemy.",""],
        "research_categories": ["rovers"],
        "gridsize": [14,14],
        "unit_collision_gridsize": [12,12],
        "art_asset": "academy",
        "equip_icon_offset": [-3,5.5], "equip_icon_delta": [1.5,0],
        "max_hp": [3000,7000],
        "defense_types": ["building"],
        "build_cost_iron": [2600,32050],
        "build_cost_water": [1200,11950],
        "build_time": [40,275],
        "repair_time": [180,240],
        "upgrade_credit_cost": [-1,3],
        "consumes_power": [55,80],
        "consumes_power_while_building": [27,40],
        "spells": ["RESEARCH_FOR_FREE", "CANCEL_RESEARCH", "UPGRADE_FOR_FREE", "CANCEL_UPGRADE", "MOVE_BUILDING"],

        "track_level_in_player_history": true,

        "requires": [
            { "predicate": "AND",
              "subpredicates": [ { "predicate": "BUILDING_QUANTITY", "building_type": "barracks", "trigger_qty": 1 },
                                 { "predicate": "BUILDING_QUANTITY", "building_type": "supply_depot", "trigger_qty": 1 },
                                 { "predicate": "BUILDING_QUANTITY", "building_type": "fuel_depot", "trigger_qty": 1 } ] },
            { "predicate": "ALWAYS_TRUE" }
        ],
        "limit": 1
    },
    "mg_tower": {
        "ui_name": "Heavy MG Tower",
        "ui_name_indefinite": "a Heavy MG Tower",
        "name": "mg_tower",
        "kind": "building",
        "ui_description": "Rapid-fire M2 machine gun hits infantry, armor and aircraft. Upgrade to increase range and damage per second.",
        "ui_damage_vs": {"rover": 3, "transport": 2, "starcraft": 2, "building": 2},
        "build_category": "defense",
        "history_category": "turrets",
        "gridsize": [7,7],
        "unit_collision_gridsize": [5,5],
        "art_asset": "guard_tower",
        "equip_icon_offset": [-3.2,3], "equip_icon_delta": [1.2,0],
        "equip_slots": { "leader": 1 },
        "turn_rate": 250,
        "muzzle_height": 1.5,
        "max_hp": [3000,4800],
        "defense_types": ["building", "turret"],
        "quarry_movable": true, "quarry_buildable": true,
        "build_cost_iron": [900,5800],
        "build_cost_water": [480,7850],
        "upgrade_credit_cost": [1,2],
        "consumes_power": [9,28],
        "consumes_power_while_building": [0,14],
        "build_time": [70,280],
        "repair_time": [5,600],
        "spells": ["MG_TOWER_SHOOT", "UPGRADE_FOR_FREE", "CANCEL_UPGRADE", "MOVE_BUILDING"],
        "requires": [
            { "predicate": "ALWAYS_TRUE" },
            { "predicate": "ALWAYS_TRUE" }
        ],
        "limit": [1,2,2]
    },
    "mortar_emplacement": {
        "ui_name": "Mortar Emplacement",
        "ui_name_indefinite": "a Mortar Emplacement",
        "name": "mortar_emplacement",
        "kind": "building",
        "ui_description": "Powerful mortar hits incoming enemy infantry and ground vehicles, dealing splash damage. Cannot hit aircraft. Upgrade to increase range, splash radius and damage.",
        "ui_damage_vs": {"rover": 2, "transport": 2, "starcraft": 0, "building": 2},
        "build_category": "defense",
        "history_category": "turrets",
        "gridsize": [7,7],
        "unit_collision_gridsize": [5,5],
        "art_asset": "tr_turret",
        "equip_icon_offset": [-3.0,3.5], "equip_icon_delta": [1.2,0],
        "turn_rate": 250,
        "muzzle_height": 1,
        "max_hp": [3000,4800],
        "defense_types": ["building", "turret"],
        "quarry_movable": true, "quarry_buildable": true,
        "build_cost_iron": [1150,11900],
        "build_cost_water": [750,8900],
        "upgrade_credit_cost": [1,4],
        "consumes_power": [12,31],
        "consumes_power_while_building": [0,16],
        "build_time": [70,580],
        "repair_time": [5,600],
        "spells": ["MORTAR_EMPLACEMENT_SHOOT", "UPGRADE_FOR_FREE", "CANCEL_UPGRADE", "MOVE_BUILDING"],
        "requires": [
            { "predicate": "ALWAYS_TRUE" },
            { "predicate": "ALWAYS_TRUE" }
        ],
        "limit": [1,2,2]
    },

    "barrier": {
        "ui_name": "HESCO Barrier",
        "ui_name_plural": "HESCO Barriers",
        "ui_name_indefinite": "a HESCO Barrier",
        "name": "barrier",
        "kind": "building",
        "ui_description": "Blocks movement of ground units and absorbs damage. Upgrade to increase durability.",
        "build_category": "defense",
        "gridsize": [2,2],
        "unit_collision_gridsize": [2,2],
        "art_asset": ["tr_barrier2_L1",
                      "tr_barrier2_L2"
                     ],
        "draw_as_wall": 1, // tells game engine to use special drawing routine for NS/EW wall segments
        "quantize_location": 2, // force positioning that makes the walls look good

        "defense_types": ["building","barrier"],
        "quarry_movable": true,

        "max_hp": [250,500],

        // limit to 50% of cap at that CC level
        "build_cost_iron":   [1250,60000],
        "build_cost_water":  [1250,60000],

        "upgrade_credit_cost": [-1,2],

        "build_time": [0,0],
        "repair_time": 5,
        "worth_less_xp": 1, "show_hp_stat": 1,
        "never_show_full_health_bar": 1,
        "spells": ["UPGRADE_FOR_FREE", "CANCEL_UPGRADE", "MOVE_BUILDING"],
        "requires": [
            { "predicate": "ALWAYS_TRUE" }, // L1
            { "predicate": "BUILDING_LEVEL", "building_type": "toc", "trigger_level": 2 } // L2
        ],
        "limit": [45,55,65]
    },

    "maintenance_bay": { // maintenance bay
        "ui_name": "Maintenance Bay",
        "ui_name_indefinite": "a Maintenance Bay",
        "name": "maintenance_bay",
        "kind": "building",
        "ui_description": "Improves ground vehicles. Upgrade this building to unlock and upgrade advanced vehicles.",
        "ui_congrats": ["Additional maintenance bay facilities installed. Advanced vehicle research available.",""],
        "build_category": "production",
        "research_categories": ["transports"],
        "equip_slots": { "leader": 1 },
        "gridsize": [14,14],
        "unit_collision_gridsize": [12,12],
        "health_bar_dims": [140,8,95],
        "art_asset": "maintenance",
        "equip_icon_offset": [-4,6], "equip_icon_delta": [1.5,0],
        "max_hp": [5000,5250],
        "defense_types": ["building"],
        "build_cost_iron": [19000,45200],
        "build_cost_water": [8200,16500],
        "upgrade_credit_cost": [-1,2],
        "consumes_power": [45,70],
        "consumes_power_while_building": [0,35],
        "build_time": [30,240],
        "repair_time": [450,900],
        "track_level_in_player_history": true,
        "spells": ["RESEARCH_FOR_FREE","CANCEL_RESEARCH", "UPGRADE_FOR_FREE", "CANCEL_UPGRADE", "MOVE_BUILDING"],
        "requires": [
            { "predicate": "BUILDING_LEVEL", "building_type": "toc", "trigger_level": 2 },
            { "predicate": "BUILDING_LEVEL", "building_type": "toc", "trigger_level": 2 }
        ],
        "limit": 1
    },

    "flight_center": {
        "ui_name": "Maintenance Hangar",
        "ui_name_indefinite": "a Maintenance Hangar",
        "name": "flight_center",
        "ui_congrats": ["Air unit research now available.", ""],
        "ui_description": "Researches new aircraft. Upgrade this building to unlock and upgrade advanced aircraft.",
        "kind": "building",
        "build_category": "production",
        "research_categories": ["starcraft"],
        "gridsize": [14,14],
        "unit_collision_gridsize": [12,12],
        "health_bar_dims": [140,8,90],
        "art_asset": "hangar",
        "equip_icon_offset": [4,1.5], "equip_icon_delta": [0,-1.5],
        "max_hp": [4100,4500],
        "defense_types": ["building"],
        "build_cost_iron": [21000,48000],
        "build_cost_water": [9000,49100],
        "upgrade_credit_cost": [-1,2],
        "consumes_power": [45,70],
        "consumes_power_while_building": [0,35],
        "build_time": [30,240],
        "repair_time": [400,400],
        "spells": ["RESEARCH_FOR_FREE","CANCEL_RESEARCH", "UPGRADE_FOR_FREE", "CANCEL_UPGRADE", "MOVE_BUILDING"],
        "requires": [
            { "predicate": "BUILDING_LEVEL", "building_type": "toc", "trigger_level": 2 },
            { "predicate": "BUILDING_LEVEL", "building_type": "toc", "trigger_level": 2 }
        ],
        "limit": 1
    },

    "motor_pool": {
        "ui_name": "Motor Pool",
        "ui_name_indefinite": "a Motor Pool",
        "ui_name_plural": "Motor Pools",
        "name": "motor_pool",
        "kind": "building",
        "ui_description": "Manufactures light and heavy armored vehicles. Upgrade to increase vehicle production and repair speed.",
        "ui_congrats": ["Vehicle production now available", ""],
        "build_category": "production",
        "manufacture_category": "transports",
        "gridsize": [16,16],
        "unit_collision_gridsize": [14,14],
        "health_bar_dims": [140,8,90],
        "art_asset": "motorpool",
        "equip_icon_offset": [6,0.8], "equip_icon_delta": [0,1.5],
        "max_hp": 8000,
        "defense_types": ["building"],
        "build_cost_iron": [2400,7000],
        "build_cost_water": [1000,2800],
        "upgrade_credit_cost": [-1,2],
        "manufacture_speed": [1.00, 1.04],
        "unit_repair_speed": [1.00, 1.02],
        "consumes_power": [18,28],
        "consumes_power_while_building": [0,14],
        "build_time": [30,1500],
        "repair_time": [5,180],
        "spells": ["MAKE_DROIDS", "UPGRADE_FOR_FREE", "CANCEL_UPGRADE", "MOVE_BUILDING"],
        "requires": [{ "predicate": "AND", "subpredicates": [
            { "predicate": "BUILDING_LEVEL", "building_type": "toc", "trigger_level": 2 },
            { "predicate": "BUILDING_QUANTITY", "building_type": "maintenance_bay", "trigger_qty": 1 }
        ] }, // L1
                     { "predicate": "ALWAYS_TRUE" } // L2
                    ],
        "limit": 1
    },

    "airfield": {
        "name": "airfield",
        "ui_name": "Airfield",
        "ui_name_indefinite": "an Airfield",
        "ui_name_plural": "Airfields",
        "kind": "building",
        "ui_description": "Produces aircraft. Upgrade to increase aircraft production and repair speed.",
        "ui_congrats": ["Aircraft production now available.", ""],
        "build_category": "production",
        "manufacture_category": "starcraft",
        "gridsize": [16,16],
        "unit_collision_gridsize": [14,14],
        "health_bar_dims": [140,8,90],
        "art_asset": "airfield",
        "equip_icon_offset": [-3,6.5], "equip_icon_delta": [1.5,0],
        "max_hp": 8000,
        "defense_types": ["building"],
        "build_cost_iron": [3100,8640],
        "build_cost_water": [1350,3200],
        "upgrade_credit_cost": [-1,5],
        "manufacture_speed": [1.00, 1.04],
        "unit_repair_speed": [1.00, 1.02],
        "consumes_power": [32,42],
        "consumes_power_while_building": [0,14],
        "build_time": [580,720],
        "repair_time": [5,180],
        "spells": ["MAKE_DROIDS", "UPGRADE_FOR_FREE", "CANCEL_UPGRADE", "MOVE_BUILDING"],
        "requires": [{ "predicate": "AND", "subpredicates": [
            { "predicate": "BUILDING_LEVEL", "building_type": "toc", "trigger_level": 3 },
            { "predicate": "BUILDING_QUANTITY", "building_type": "maintenance_bay", "trigger_qty": 1 }
        ] },
                     { "predicate": "ALWAYS_TRUE" }
                    ],
        "limit": 1
    },

    "warehouse": {
        "ui_name": "Warehouse",
        "ui_name_indefinite": "a Warehouse",
        "name": "warehouse",
        "kind": "building",
        "build_category": "resources",
        "ui_description": "Stores items received during operations. Upgrade to increase number of storage slots.",
        "gridsize": [10,10],
        "unit_collision_gridsize": [8,8],
        "art_asset": "tr_warehouse",
        "equip_icon_offset": [-4,5], "equip_icon_delta": [1.5,0],
        // how many inventory slots it gives at each level
        "provides_inventory": [7,8],
        "max_hp": [3000,7000],
        "defense_types": ["building"],

        "build_cost_iron": [1, 32000],
        "build_cost_water":[1, 12000],

        "build_time": [30,30],
        "upgrade_credit_cost": [-1,5],
        "repair_time": [5,5],

        // L1 power requirement is nerfed to avoid disrupting the tutorial
        "consumes_power": [1,80],
        "consumes_power_while_building": [1,40],

        "spells": ["UPGRADE_FOR_FREE", "CANCEL_UPGRADE", "MOVE_BUILDING"],
        "track_level_in_player_history": true,

        "requires": [
            { "predicate": "BUILDING_LEVEL", "building_type": "toc", "trigger_level": 1 }, // L1
            { "predicate": "BUILDING_LEVEL", "building_type": "toc", "trigger_level": 2 } // L2
        ],
        "limit": 1
    },

    "squad_bay": {
        "name": "squad_bay",
        "ui_name": "Reserves Bay",
        "ui_name_indefinite": "a Reserves Bay",
        "kind": "building",
        "build_category": "production",
        "ui_description": "Enables play on Regional Map by moving units from your Base Defenders to Battalions, which can travel the map, and to Reserves, which protect units from damage during base defense.",
        "ui_congrats": ["Unit reserves, Battalions, and Regional Map deployment enabled!",""],
        "gridsize": [14,14], // start as big as possible, we can shrink later
        "unit_collision_gridsize": [12,12],
        "art_asset": "tr_reserves_bay",
        "equip_icon_offset": [-4,6], "equip_icon_delta": [1.5,0],

        "max_hp": [1000,2000],
        "defense_types": ["building"],

        "build_cost_iron": [285,735],
        "build_cost_water": [285,735],
        "build_time": [0,112],
        "repair_time": [5,5],
        "upgrade_credit_cost": [1,1],

        // note: L1 power requirement is nerfed to avoid disrupting the tutorial
        "consumes_power": [1,12],
        "consumes_power_while_building": [0,6],
        "provides_squads": [50,50], // max # of squads (not counting base defenders or reserves)
        "provides_deployed_squads": [10,10], // max # of squads deployed on map at once
        "provides_squad_space": [345,345], // unit capacity of each squad (except base defenders, which is determined by provides_space on the TOC)
        "provides_total_space": [2070,2760], // unit capacity of entire army

        "spells": ["MANAGE_SQUADS", "UPGRADE_FOR_FREE", "CANCEL_UPGRADE", "MOVE_BUILDING"],
        "history_category": "squad_bay",
        "track_level_in_player_history": true,

        "requires": [
            { "predicate": "AND", "subpredicates": [
                { "predicate": "LIBRARY", "name": "quarry_requirement" },
                { "predicate": "BUILDING_QUANTITY", "building_type": "transmitter", "trigger_qty": 1 }
            ] }, // L1
            { "predicate": "BUILDING_LEVEL", "building_type": "toc", "trigger_level": 2 } // L2
        ],
        "limit": 1
    },

    "barracks": {
        "ui_name": "Barracks",
        "ui_name_indefinite": "a Barracks",
        "ui_name_plural": "Barracks",
        "name": "barracks",
        "kind": "building",
        "ui_description": "Trains infantry. Upgrade to increase training and healing speed of infantry units.",
        "build_category": "production",
        "manufacture_category": "rovers",
        "gridsize": [16,16],
        "unit_collision_gridsize": [14,14],
        "art_asset": "barracks",
        "equip_icon_offset": [-1.5,5], "equip_icon_delta": [1.5,0],
        "max_hp": [3000,7000],
        "defense_types": ["building"],
        "build_cost_iron": [0,6000],
        "build_cost_water": [0,2215],
        "upgrade_credit_cost": [-1,3],
        // speed of manufacturing units, relative to unit base manufacture time
        "manufacture_speed": [1.00, 1.04],
        "unit_repair_speed": [1.00, 1.02],
        "consumes_power": [12,22],
        "consumes_power_while_building": [0,11],
        "build_time": [290,7200],
        "repair_time": [5,180],
        "spells": ["MAKE_DROIDS", "CANCEL_MAKE_DROIDS", "UPGRADE_FOR_FREE", "CANCEL_UPGRADE", "MOVE_BUILDING" ],
        "requires": [ { "predicate": "ALWAYS_TRUE" }, // L1
                      { "predicate": "BUILDING_LEVEL", "building_type": "toc", "trigger_level": 2 } // L2
                    ],
        "limit": 1
    },

    "transmitter": {
        "name": "transmitter",
        "ui_name": "Transmitter",
        "ui_name_indefinite": "a Transmitter",

        "ui_description": "Enables you to create and join Clans, receive reinforcements from clanmates and to change region maps. Upgrade to increase space available for donated reinforcement units.",
        "ui_congrats": ["","Clans unlocked!\n\nClick the Transmitter to join or create a Clan."],
        "kind": "building",
        "build_category": "production",
        "gridsize": [8,8],
        "unit_collision_gridsize": [6,6],
        "destroyed_asset": "building_crater_7x7",
        "under_construction_asset": "building_construction_7x7",
        "art_asset": "tr_transmitter",
        "equip_icon_offset": [3,-3], "equip_icon_delta": [0,1.2],
        "click_detection": "sprite", // use sprite-rect-based hit detection because it's tall and clicks usually miss the base
        "provides_quarry_control": [5,6], // enables controlling this # of quarries
        "max_hp": [10000,12500],
        "defense_types": ["building"],
        "build_cost_iron":  [1000,1200],
        "build_cost_water": [1000,1200],
        "upgrade_credit_cost": [1,1],
        "consumes_power": [0,25],
        "consumes_power_while_building": [0,12],
        "build_time": [0,30],
        "repair_time": [30,30],
        // how much unit space the building provides for RECEIVING donated units
        "provides_donated_space": [0,170],
        // how big of a unit the player can GIVE
        "max_individual_donation_space": [0,350],
        // Upgrade Transmitter to Level X to enable donation of this unit
        // This unit is too large to be donated
        "spells": ["UPGRADE_FOR_FREE", "CANCEL_UPGRADE", "MOVE_BUILDING", "REQUEST_UNIT_DONATION", "DONATE_UNITS"],
        "requires": [
            { "predicate": "ALWAYS_TRUE" }, // L1
            { "predicate": "BUILDING_LEVEL", "building_type": "toc", "trigger_level": 3 } // L2
        ],
        "limit": 1,
        "track_level_in_player_history": true,
        // [x,y] pixel offset at which to draw alliance membership. Only should be on one building.
        "show_alliance_at": [0,25]
    }
}


